<!DOCTYPE html>
<html>
<head>
	<style>
		.customClass{
			background-color: yellow;
		}
	</style>
</head>
<body>

<p id="passage">This is a paragraph with some words . This is second paragraph with some words.</p>
<button onclick="highlight(0,4)">This</button>
<button onclick="highlight(5,7)">is</button>
<button onclick="highlight(10,19)">paragraph</button>
<button onclick="highlight(36,37)">.</button>
<button onclick="highlight(38,42)">This</button>
<button onclick="highlight(46,52)">Second</button>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script>

	function highlight(start, end){
		
		var text = $("#passage").text();
		var html = $("#passage").html();
		
		var first = text.substring(0, start);
		var string = text.substring(start, end);
		var second = text.substring(end, text.length);
		
		text = first + "<span style='color:red'>" + string + "</span>" + second;
		console.log(text);
		var textArr = text.split("");
		var htmlArr = html.split("");
		var finalArr = [];
		var finalArrCounter = 0;
		var currentTextCounter = 0;
		var currentHtmlCounter = 0;
		var terminate = 0;
		while((currentTextCounter < text.length) && (currentHtmlCounter < html.length) && (terminate<1000)){
		terminate++;
		//while(false){
			//console.log(currentTextCounter+" "+currentHtmlCounter);
			//console.log(textArr[currentTextCounter]+" "+textArr[currentTextCounter-1]+" "+htmlArr[currentHtmlCounter]+" "+htmlArr[currentHtmlCounter-1]+" "+htmlArr[currentHtmlCounter-2]);
			if(textArr[currentTextCounter] == htmlArr[currentHtmlCounter]){
				finalArr[finalArrCounter] = textArr[currentTextCounter];
				finalArrCounter++;
				currentTextCounter++;
				currentHtmlCounter++;
			}else if((textArr[currentTextCounter] == "<") && (textArr[currentTextCounter+1] == "s")){
				currentTextCounter += 24;
				finalArr[finalArrCounter] = "<";
				finalArrCounter++;
				finalArr[finalArrCounter] = "s";
				finalArrCounter++;
				finalArr[finalArrCounter] = "p";
				finalArrCounter++;
				finalArr[finalArrCounter] = "a";
				finalArrCounter++;
				finalArr[finalArrCounter] = "n";
				finalArrCounter++;
				finalArr[finalArrCounter] = " ";
				finalArrCounter++;
				finalArr[finalArrCounter] = "c";
				finalArrCounter++;
				finalArr[finalArrCounter] = "l";
				finalArrCounter++;
				finalArr[finalArrCounter] = "a";
				finalArrCounter++;
				finalArr[finalArrCounter] = "s";
				finalArrCounter++;
				finalArr[finalArrCounter] = "s";
				finalArrCounter++;
				finalArr[finalArrCounter] = "=";
				finalArrCounter++;
				finalArr[finalArrCounter] = "'";
				finalArrCounter++;
				finalArr[finalArrCounter] = "c";
				finalArrCounter++;
				finalArr[finalArrCounter] = "u";
				finalArrCounter++;
				finalArr[finalArrCounter] = "s";
				finalArrCounter++;
				finalArr[finalArrCounter] = "t";
				finalArrCounter++;
				finalArr[finalArrCounter] = "o";
				finalArrCounter++;
				finalArr[finalArrCounter] = "m";
				finalArrCounter++;
				finalArr[finalArrCounter] = "C";
				finalArrCounter++;
				finalArr[finalArrCounter] = "l";
				finalArrCounter++;
				finalArr[finalArrCounter] = "a";
				finalArrCounter++;
				finalArr[finalArrCounter] = "s";
				finalArrCounter++;
				finalArr[finalArrCounter] = "s";
				finalArrCounter++;
				finalArr[finalArrCounter] = "'";
				finalArrCounter++;
				finalArr[finalArrCounter] = ">";
				finalArrCounter++;
			}else if((textArr[currentTextCounter] == "<") && (textArr[currentTextCounter+1] != "s")){
				currentTextCounter += 7;
				finalArr[finalArrCounter] = "<";
				finalArrCounter++;
				finalArr[finalArrCounter] = "/";
				finalArrCounter++;
				finalArr[finalArrCounter] = "s";
				finalArrCounter++;
				finalArr[finalArrCounter] = "p";
				finalArrCounter++;
				finalArr[finalArrCounter] = "a";
				finalArrCounter++;
				finalArr[finalArrCounter] = "n";
				finalArrCounter++;
				finalArr[finalArrCounter] = ">";
				finalArrCounter++;
			}else if((htmlArr[currentHtmlCounter] == "<") && (htmlArr[currentHtmlCounter+1] == "s")){
				currentHtmlCounter += 26;
				finalArr[finalArrCounter] = "<";
				finalArrCounter++;
				finalArr[finalArrCounter] = "s";
				finalArrCounter++;
				finalArr[finalArrCounter] = "p";
				finalArrCounter++;
				finalArr[finalArrCounter] = "a";
				finalArrCounter++;
				finalArr[finalArrCounter] = "n";
				finalArrCounter++;
				finalArr[finalArrCounter] = " ";
				finalArrCounter++;
				finalArr[finalArrCounter] = "c";
				finalArrCounter++;
				finalArr[finalArrCounter] = "l";
				finalArrCounter++;
				finalArr[finalArrCounter] = "a";
				finalArrCounter++;
				finalArr[finalArrCounter] = "s";
				finalArrCounter++;
				finalArr[finalArrCounter] = "s";
				finalArrCounter++;
				finalArr[finalArrCounter] = "=";
				finalArrCounter++;
				finalArr[finalArrCounter] = "'";
				finalArrCounter++;
				finalArr[finalArrCounter] = "c";
				finalArrCounter++;
				finalArr[finalArrCounter] = "u";
				finalArrCounter++;
				finalArr[finalArrCounter] = "s";
				finalArrCounter++;
				finalArr[finalArrCounter] = "t";
				finalArrCounter++;
				finalArr[finalArrCounter] = "o";
				finalArrCounter++;
				finalArr[finalArrCounter] = "m";
				finalArrCounter++;
				finalArr[finalArrCounter] = "C";
				finalArrCounter++;
				finalArr[finalArrCounter] = "l";
				finalArrCounter++;
				finalArr[finalArrCounter] = "a";
				finalArrCounter++;
				finalArr[finalArrCounter] = "s";
				finalArrCounter++;
				finalArr[finalArrCounter] = "s";
				finalArrCounter++;
				finalArr[finalArrCounter] = "'";
				finalArrCounter++;
				finalArr[finalArrCounter] = ">";
				finalArrCounter++;
			}else if((htmlArr[currentHtmlCounter] == "<") && (htmlArr[currentHtmlCounter+1] != "s")){
				currentHtmlCounter += 7;
				finalArr[finalArrCounter] = "<";
				finalArrCounter++;
				finalArr[finalArrCounter] = "/";
				finalArrCounter++;
				finalArr[finalArrCounter] = "s";
				finalArrCounter++;
				finalArr[finalArrCounter] = "p";
				finalArrCounter++;
				finalArr[finalArrCounter] = "a";
				finalArrCounter++;
				finalArr[finalArrCounter] = "n";
				finalArrCounter++;
				finalArr[finalArrCounter] = ">";
				finalArrCounter++;
			}
		}
		var finalHtml = finalArr.join('');
		$("#passage").html(finalHtml);
		
	}

</script>
</body>
</html>